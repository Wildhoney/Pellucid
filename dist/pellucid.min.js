!function(e,t){"use strict";var r="pellucid-container",n={WIDTH_HEIGHT:"width-height",OFFSET_TOP:"offset-top",OFFSET_LEFT:"offset-left",OFFSET_RESET:"offset-reset"},i=function(){return e.self!==e.top},a=function(){};a.prototype={options:{blur:"5px"},setOptions:function(e){for(var t in e.attributes)if(e.attributes.hasOwnProperty(t)){var r=e.attributes[t];if(r.name){var n=r.name.toLowerCase().replace(/^data-/i,""),i=new RegExp("^pellucid-","i");n.match(i)&&(n=n.replace(i,""),this.options[n]=r.value,e.removeAttribute("pellucid-"+n),e.removeAttribute("data-pellucid-"+n))}}},removeAllContainers:function(){for(var e=t.querySelectorAll('section[is="'+r+'"]'),n=0,i=e.length;i>n;n++)e[n].remove()},computedParentValue:function(t){var r=e.parent.document.querySelector("html"),n=e.getComputedStyle(r);return n.getPropertyValue(t)},createFrameElement:function(e){var r=t.createElement("iframe");return r.className="pellucid",r.src=t.URL+"?",r.onload=function(){this.frameElementJustify(e,r)}.bind(this),r},frameElementJustify:function(t,r){r||(r=t.querySelector("iframe.pellucid"));var n=function(r){var n=e.getComputedStyle(t)[r];if(t.style.transform){var i=String(t.style.transform).match(/(?:((?:\-)?\d+)px)/g),a="top"===r?1:0;n=parseInt(n)+parseInt(i[a])}return n},i=r.contentWindow,a=isNaN(parseInt(n("top")))?0:parseInt(n("top")),l=isNaN(parseInt(n("left")))?0:parseInt(n("left"));return this.computeFrameOffsets(t,r,a,l),i.scrollTo(l,a),{left:l,top:a}},computeFrameOffsets:function(r,i,a,l){var o=parseInt(e.getComputedStyle(r).getPropertyValue("width")),s=parseInt(e.getComputedStyle(r).getPropertyValue("height")),u=e.innerWidth,c=e.parseInt(e.getComputedStyle(t.querySelector("html")).getPropertyValue("height")),p=function(e,t){i.contentWindow.postMessage({name:e,params:t},"*")};p(n.OFFSET_RESET),0>l&&p(n.OFFSET_LEFT,{offsetLeft:Math.abs(l)}),o+l>u&&p(n.OFFSET_LEFT,{offsetLeft:-Math.abs(l)}),0>a&&p(n.OFFSET_TOP,{offsetTop:Math.abs(a)}),s+a>c&&p(n.OFFSET_TOP,{offsetTop:-Math.abs(a)})},createStructureElement:function(e,r){var n=t.createElement("div");return n.className=r,n.style.width="100%",n.style.height="100%",n.style.position="absolute",n.style.top=0,n.style.left=0,e.appendChild(n),n},addFrameElement:function(e,t){t.appendChild(e)},isParent:function(e){return!!e.contentWindow},styleChildFrameElement:function(r){r=t.querySelector("html");var i=e.parent.window;r.style.height=i.innerHeight+"px",r.style.width=parseInt(this.computedParentValue("width"))+"px",r.style.overflow="hidden",r.style.pointerEvents="none",r.style.position="absolute",r.style.filter="blur("+this.options.blur+")",r.style.oFilter="blur("+this.options.blur+")",r.style.mozFilter="blur("+this.options.blur+")",r.style.webkitFilter="blur("+this.options.blur+")",e.onmessage=function(e){switch(e.data.name){case n.WIDTH_HEIGHT:r.style.height=e.data.params.height,r.style.width=e.data.params.width;break;case n.OFFSET_LEFT:r.style.marginLeft=e.data.params.offsetLeft+"px";break;case n.OFFSET_TOP:r.style.marginTop=e.data.params.offsetTop+"px";break;case n.OFFSET_RESET:r.style.marginLeft=0,r.style.marginTop=0}}},styleParentFrameElement:function(e){var t=e.contentWindow,r=t.document.querySelector("html");r.style.width="100%",r.style.height="100%"},addRenderListener:function(r,i){var a=t.querySelector("body");e.onresize=function(){var t=e.getComputedStyle(a);i.contentWindow.postMessage({name:n.WIDTH_HEIGHT,params:{width:t.getPropertyValue("width"),height:t.getPropertyValue("height")}},"*")}.bind(this)},removeContentNodes:function(e){for(var t=[],r=0,n=e.childNodes.length;n>r;r++){var i=e.childNodes[r];t.push(i)}return t.forEach(function(e){e.remove()}),t},reattachContentElements:function(e,t){t.forEach(function(t){e.appendChild(t)})}};var l=Object.create(HTMLDivElement.prototype,{attachedCallback:{value:function(){this.pellucid=new a,this.pellucid.setOptions(this);var e=this.pellucid.createFrameElement(this),t=this.pellucid.removeContentNodes(this),r=this.pellucid.createStructureElement(this,"background"),n=this.pellucid.createStructureElement(this,"content");return this.pellucid.reattachContentElements(n,t),i()?(this.pellucid.removeAllContainers(),void this.pellucid.styleChildFrameElement(e)):(this.pellucid.addFrameElement(e,r),this.pellucid.styleParentFrameElement(e),void(this.pellucid.isParent(e)&&this.pellucid.addRenderListener(this,e)))}}});e.PellucidElement=t.registerElement(r,{prototype:l,"extends":"section"})}(window,window.document);